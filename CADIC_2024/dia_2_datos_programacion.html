<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Verónica Cruz-Alonso">
<meta name="author" content="Julen Astigarraga">
<meta name="dcterms.date" content="2024-03-12">

<title>quarto-input51805e55ae17e667</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="dia_2_datos_programacion_files/libs/clipboard/clipboard.min.js"></script>
<script src="dia_2_datos_programacion_files/libs/quarto-html/quarto.js"></script>
<script src="dia_2_datos_programacion_files/libs/quarto-html/popper.min.js"></script>
<script src="dia_2_datos_programacion_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="dia_2_datos_programacion_files/libs/quarto-html/anchor.min.js"></script>
<link href="dia_2_datos_programacion_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="dia_2_datos_programacion_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="dia_2_datos_programacion_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="dia_2_datos_programacion_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="dia_2_datos_programacion_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#objetivos-del-día-2" id="toc-objetivos-del-día-2" class="nav-link active" data-scroll-target="#objetivos-del-día-2"><span class="header-section-number">1</span> Objetivos del día 2</a></li>
  <li><a href="#introducción-a-tidyverse" id="toc-introducción-a-tidyverse" class="nav-link" data-scroll-target="#introducción-a-tidyverse"><span class="header-section-number">2</span> Introducción a tidyverse</a></li>
  <li><a href="#importar-datos-y-renombrar-variables" id="toc-importar-datos-y-renombrar-variables" class="nav-link" data-scroll-target="#importar-datos-y-renombrar-variables"><span class="header-section-number">3</span> Importar datos y renombrar variables</a>
  <ul>
  <li><a href="#read_delim-leer-datos-desde-fuera-de-r" id="toc-read_delim-leer-datos-desde-fuera-de-r" class="nav-link" data-scroll-target="#read_delim-leer-datos-desde-fuera-de-r"><span class="header-section-number">3.1</span> Read_delim: leer datos desde fuera de R</a></li>
  <li><a href="#rename-cambiar-nombres-de-variables-columnas" id="toc-rename-cambiar-nombres-de-variables-columnas" class="nav-link" data-scroll-target="#rename-cambiar-nombres-de-variables-columnas"><span class="header-section-number">3.2</span> Rename: cambiar nombres de variables (columnas)</a></li>
  </ul></li>
  <li><a href="#funciones-básicas-de-filtrado-y-selección" id="toc-funciones-básicas-de-filtrado-y-selección" class="nav-link" data-scroll-target="#funciones-básicas-de-filtrado-y-selección"><span class="header-section-number">4</span> Funciones básicas de filtrado y selección</a>
  <ul>
  <li><a href="#slice-filtrar-filas-según-el-índice-numérico" id="toc-slice-filtrar-filas-según-el-índice-numérico" class="nav-link" data-scroll-target="#slice-filtrar-filas-según-el-índice-numérico"><span class="header-section-number">4.1</span> Slice: filtrar filas según el índice numérico</a></li>
  <li><a href="#arrange-ordenar-filas-por-los-valores-de-una-o-más-variables-columnas" id="toc-arrange-ordenar-filas-por-los-valores-de-una-o-más-variables-columnas" class="nav-link" data-scroll-target="#arrange-ordenar-filas-por-los-valores-de-una-o-más-variables-columnas"><span class="header-section-number">4.2</span> Arrange: ordenar filas por los valores de una o más variables (columnas)</a></li>
  <li><a href="#filter-filtrar-filas-utilizando-condiciones" id="toc-filter-filtrar-filas-utilizando-condiciones" class="nav-link" data-scroll-target="#filter-filtrar-filas-utilizando-condiciones"><span class="header-section-number">4.3</span> Filter: filtrar filas utilizando condiciones</a>
  <ul class="collapse">
  <li><a href="#ejercicio" id="toc-ejercicio" class="nav-link" data-scroll-target="#ejercicio"><span class="header-section-number">4.3.1</span> Ejercicio</a></li>
  </ul></li>
  <li><a href="#select-seleccionar-columnas-utilizando-condiciones" id="toc-select-seleccionar-columnas-utilizando-condiciones" class="nav-link" data-scroll-target="#select-seleccionar-columnas-utilizando-condiciones"><span class="header-section-number">4.4</span> Select: seleccionar columnas utilizando condiciones</a>
  <ul class="collapse">
  <li><a href="#ejercicio-1" id="toc-ejercicio-1" class="nav-link" data-scroll-target="#ejercicio-1"><span class="header-section-number">4.4.1</span> Ejercicio</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#transformar-los-datos-y-calcular-nuevas-variables" id="toc-transformar-los-datos-y-calcular-nuevas-variables" class="nav-link" data-scroll-target="#transformar-los-datos-y-calcular-nuevas-variables"><span class="header-section-number">5</span> Transformar los datos y calcular nuevas variables</a>
  <ul>
  <li><a href="#mutate-crear-modificar-o-eliminar-columnas" id="toc-mutate-crear-modificar-o-eliminar-columnas" class="nav-link" data-scroll-target="#mutate-crear-modificar-o-eliminar-columnas"><span class="header-section-number">5.1</span> Mutate: crear, modificar o eliminar columnas</a>
  <ul class="collapse">
  <li><a href="#ejercicio-2" id="toc-ejercicio-2" class="nav-link" data-scroll-target="#ejercicio-2"><span class="header-section-number">5.1.1</span> Ejercicio</a></li>
  </ul></li>
  <li><a href="#summarise-y-group-by-generar-un-nuevo-data.frame-resumiendo-cada-grupo-a-una-fila" id="toc-summarise-y-group-by-generar-un-nuevo-data.frame-resumiendo-cada-grupo-a-una-fila" class="nav-link" data-scroll-target="#summarise-y-group-by-generar-un-nuevo-data.frame-resumiendo-cada-grupo-a-una-fila"><span class="header-section-number">5.2</span> Summarise y group by: generar un nuevo <code>data.frame</code> resumiendo cada grupo a una fila</a>
  <ul class="collapse">
  <li><a href="#ejercicio-3" id="toc-ejercicio-3" class="nav-link" data-scroll-target="#ejercicio-3"><span class="header-section-number">5.2.1</span> Ejercicio</a></li>
  </ul></li>
  <li><a href="#pivot-transformar-datos-a-formato-ancho-a-largo-y-viceversa" id="toc-pivot-transformar-datos-a-formato-ancho-a-largo-y-viceversa" class="nav-link" data-scroll-target="#pivot-transformar-datos-a-formato-ancho-a-largo-y-viceversa"><span class="header-section-number">5.3</span> Pivot: transformar datos a formato ancho a largo y viceversa</a></li>
  </ul></li>
  <li><a href="#joins-unir-data.frames" id="toc-joins-unir-data.frames" class="nav-link" data-scroll-target="#joins-unir-data.frames"><span class="header-section-number">6</span> Joins: unir data.frames</a></li>
  <li><a href="#write_delim-guardar-datos" id="toc-write_delim-guardar-datos" class="nav-link" data-scroll-target="#write_delim-guardar-datos"><span class="header-section-number">7</span> Write_delim: guardar datos</a></li>
  <li><a href="#enlaces-de-interés-sobre-manipulación-de-datos" id="toc-enlaces-de-interés-sobre-manipulación-de-datos" class="nav-link" data-scroll-target="#enlaces-de-interés-sobre-manipulación-de-datos"><span class="header-section-number">8</span> Enlaces de interés sobre manipulación de datos</a></li>
  <li><a href="#introducción-a-la-programación-funcional" id="toc-introducción-a-la-programación-funcional" class="nav-link" data-scroll-target="#introducción-a-la-programación-funcional"><span class="header-section-number">9</span> Introducción a la programación funcional</a>
  <ul>
  <li><a href="#cuándo-hay-que-usar-una-función" id="toc-cuándo-hay-que-usar-una-función" class="nav-link" data-scroll-target="#cuándo-hay-que-usar-una-función"><span class="header-section-number">9.1</span> ¿Cuándo hay que usar una función?</a></li>
  </ul></li>
  <li><a href="#teoría-sobre-funciones-en-r" id="toc-teoría-sobre-funciones-en-r" class="nav-link" data-scroll-target="#teoría-sobre-funciones-en-r"><span class="header-section-number">10</span> Teoría sobre funciones en R</a></li>
  <li><a href="#sec-writefun" id="toc-sec-writefun" class="nav-link" data-scroll-target="#sec-writefun"><span class="header-section-number">11</span> Cómo escribir funciones</a>
  <ul>
  <li><a href="#ejercicio-4" id="toc-ejercicio-4" class="nav-link" data-scroll-target="#ejercicio-4"><span class="header-section-number">11.0.1</span> Ejercicio</a></li>
  <li><a href="#ejercicio-5" id="toc-ejercicio-5" class="nav-link" data-scroll-target="#ejercicio-5"><span class="header-section-number">11.0.2</span> Ejercicio</a></li>
  <li><a href="#argumentos" id="toc-argumentos" class="nav-link" data-scroll-target="#argumentos"><span class="header-section-number">11.1</span> Argumentos</a></li>
  </ul></li>
  <li><a href="#iteraciones-con-bucles-for" id="toc-iteraciones-con-bucles-for" class="nav-link" data-scroll-target="#iteraciones-con-bucles-for"><span class="header-section-number">12</span> Iteraciones con bucles <em>for</em></a></li>
  <li><a href="#iteraciones-con-funcionales" id="toc-iteraciones-con-funcionales" class="nav-link" data-scroll-target="#iteraciones-con-funcionales"><span class="header-section-number">13</span> Iteraciones con funcionales</a>
  <ul>
  <li><a href="#nuestro-primer-funcional-generando-listas-map" id="toc-nuestro-primer-funcional-generando-listas-map" class="nav-link" data-scroll-target="#nuestro-primer-funcional-generando-listas-map"><span class="header-section-number">13.1</span> Nuestro primer funcional: generando listas, <code>map()</code></a>
  <ul class="collapse">
  <li><a href="#ejercicio-6" id="toc-ejercicio-6" class="nav-link" data-scroll-target="#ejercicio-6"><span class="header-section-number">13.1.1</span> Ejercicio</a></li>
  </ul></li>
  <li><a href="#nuestro-segundo-funcional-generando-vectores-y-data.frames-map_" id="toc-nuestro-segundo-funcional-generando-vectores-y-data.frames-map_" class="nav-link" data-scroll-target="#nuestro-segundo-funcional-generando-vectores-y-data.frames-map_"><span class="header-section-number">13.2</span> Nuestro segundo funcional: generando vectores y data.frames, <code>map_*()</code></a>
  <ul class="collapse">
  <li><a href="#ejercicio-7" id="toc-ejercicio-7" class="nav-link" data-scroll-target="#ejercicio-7"><span class="header-section-number">13.2.1</span> Ejercicio</a></li>
  </ul></li>
  <li><a href="#enlaces-de-interés-sobre-programación-funcional" id="toc-enlaces-de-interés-sobre-programación-funcional" class="nav-link" data-scroll-target="#enlaces-de-interés-sobre-programación-funcional"><span class="header-section-number">13.3</span> Enlaces de interés sobre programación funcional</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="dia_2_datos_programacion.md"><i class="bi bi-file-code"></i>Github (GFM)</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><div class="line-block">Organización de datos y bases de programación funcional</div></h1>
<p class="subtitle lead">Curso: Programación y análisis estadístico en R. CADIC, Ushuaia, Argentina</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Verónica Cruz-Alonso </p>
             <p>Julen Astigarraga </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">03/12/2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="objetivos-del-día-2" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="objetivos-del-día-2"><span class="header-section-number">1</span> Objetivos del día 2</h2>
<ul>
<li><p>Entender la filosofía de {tidyverse}.</p></li>
<li><p>Aprender funciones básicas que nos permitan importar, explorar, limpiar, transformar y manejar datos.</p></li>
<li><p>Aprender a escribir funciones.</p></li>
<li><p>Entender la programación iterativa mediante el paquete {purrr} de {tidyverse}.</p></li>
</ul>
</section>
<section id="introducción-a-tidyverse" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="introducción-a-tidyverse"><span class="header-section-number">2</span> Introducción a tidyverse</h2>
<p><a href="https://www.tidyverse.org/"><em>Tidyverse</em></a> es una colección de paquetes (meta-paquete) de R. El núcleo contiene ocho paquetes principales (<code>readr</code>, <code>tibble</code>, <code>dplyr</code>, <code>tidyr</code>, <code>stringr</code>, <code>forcats</code>, <code>ggplot2</code> y <code>purrr</code>), que comparten el diseño, la gramática y la estructura de los datos que necesitan. En el centro de la filosofía de tidyverse se encuentra la noción de “datos ordenados” (<em>tidy data</em>). Hadley Wickham (principal desarrollador de <em>tidyverse</em>) los define como “fáciles de manipular, modelar y visualizar, y que tienen una estructura específica: cada variable es una columna, cada observación es una fila y cada valor es una celda”. <em>Tidyverse</em> puede considerarse un dialecto del lenguaje de programación R que discretiza funciones amplias de R base (p.&nbsp;ej. <code>merge</code>) en diversas funciones específicas (p.&nbsp;ej. <code>left_join</code>, <code>right_join</code>).</p>
<p>Los <a href="https://design.tidyverse.org/unifying.html">tres principios básicos</a> de este meta-paquete son:</p>
<ul>
<li><p><strong>Centrado en humanos</strong>: tiene un diseño intuitivo que facilita su uso y accesibilidad para el usuario, ya que está diseñado específicamente para respaldar las actividades de un analista de datos humano.</p></li>
<li><p><strong>Consistencia</strong>: todos los paquetes están diseñados para trabajar con datos ordenados (<em>tidy data</em>), y las funciones de los paquetes tienen una nomenclatura común y congruente. Esto permite que un usuario que aprende sobre una función o paquete pueda aplicar ese conocimiento a otros, facilitando así la tarea de recordar y deducir código.</p></li>
<li><p><strong>Componiblidad</strong>: permite al usuario resolver problemas complejos dividiéndolos en pequeñas partes, que pueden combinarse utilizando el operador <em>pipe</em>, ya sea el del paquete <code>magrittr</code> (<code>%&gt;%</code>) o el creado recientemente en R base (<code>|&gt;</code>).</p></li>
</ul>
<p>💡Los dos operador <em>pipe</em> tienen pequeñas <a href="https://www.tidyverse.org/blog/2023/04/base-vs-magrittr-pipe/">diferencias</a> pero en general el comportamiento es el mismo.</p>
<p>💡Para más información sobre <em>tidyverse</em> y las diferencias con R base te recomendamos leer <a href="https://revistaecosistemas.net/index.php/ecosistemas/article/view/2745"><em>Tidyverse: colección de paquetes de R para la ciencia de datos</em></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"hi"</span>, <span class="st">"hola"</span>, <span class="st">"hola"</span>, <span class="st">"hi"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(d))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> <span class="fu">unique</span>() <span class="sc">|&gt;</span> <span class="fu">length</span>() <span class="co"># Ctrl + Shift + M para poner un pipe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>En este curso realizaremos las distintas tareas que forman parte de la ciencia de datos utilizando <em>tidyverse</em>, aunque también se podrían llevar a cabo con R base.</p>
</section>
<section id="importar-datos-y-renombrar-variables" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="importar-datos-y-renombrar-variables"><span class="header-section-number">3</span> Importar datos y renombrar variables</h2>
<section id="read_delim-leer-datos-desde-fuera-de-r" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="read_delim-leer-datos-desde-fuera-de-r"><span class="header-section-number">3.1</span> <a href="https://readr.tidyverse.org/reference/read_delim.html">Read_delim</a>: leer datos desde fuera de R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>taludes <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"taludes.csv"</span>, <span class="at">delim =</span> <span class="st">","</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>taludes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 91 × 3
   Biomasa Luz     Agua          
     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;         
 1    3.04 Nivel 1 Sequia estival
 2    3.57 Nivel 1 Sequia estival
 3    3.67 Nivel 1 Sequia estival
 4    4.59 Nivel 1 Sequia estival
 5    4.34 Nivel 1 Sequia estival
 6    2.25 Nivel 1 Sequia estival
 7    4.12 Nivel 1 Sequia estival
 8    2.45 Nivel 1 Sequia estival
 9    4.46 Nivel 1 Sequia estival
10    3.51 Nivel 1 Sequia estival
# ℹ 81 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"taludes.csv"</span>, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">delim =</span> <span class="st">","</span>, <span class="at">col_types =</span> <span class="fu">list</span>(<span class="at">Luz =</span> <span class="st">"f"</span>, <span class="at">Agua =</span> <span class="st">"f"</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>taludes_bien</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 91 × 3
   Biomasa Luz     Agua          
     &lt;dbl&gt; &lt;fct&gt;   &lt;fct&gt;         
 1    3.04 Nivel 1 Sequia estival
 2    3.57 Nivel 1 Sequia estival
 3    3.67 Nivel 1 Sequia estival
 4    4.59 Nivel 1 Sequia estival
 5    4.34 Nivel 1 Sequia estival
 6    2.25 Nivel 1 Sequia estival
 7    4.12 Nivel 1 Sequia estival
 8    2.45 Nivel 1 Sequia estival
 9    4.46 Nivel 1 Sequia estival
10    3.51 Nivel 1 Sequia estival
# ℹ 81 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(taludes_bien)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(taludes_bien)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Biomasa           Luz                 Agua   
 Min.   :2.120   Nivel 1:30   Sequia estival:46  
 1st Qu.:3.531   Nivel 2:31   Lluvia estival:45  
 Median :4.053   Nivel 3:30                      
 Mean   :3.993                                   
 3rd Qu.:4.609                                   
 Max.   :5.347                                   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(taludes_bien)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 91
Columns: 3
$ Biomasa &lt;dbl&gt; 3.039767, 3.573515, 3.669172, 4.592334, 4.337278, 2.254230, 4.…
$ Luz     &lt;fct&gt; Nivel 1, Nivel 1, Nivel 1, Nivel 1, Nivel 1, Nivel 1, Nivel 1,…
$ Agua    &lt;fct&gt; Sequia estival, Sequia estival, Sequia estival, Sequia estival…</code></pre>
</div>
</div>
</section>
<section id="rename-cambiar-nombres-de-variables-columnas" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="rename-cambiar-nombres-de-variables-columnas"><span class="header-section-number">3.2</span> <a href="https://dplyr.tidyverse.org/reference/rename.html">Rename</a>: cambiar nombres de variables (columnas)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(taludes_bien)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Biomasa" "Luz"     "Agua"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="ot">&lt;-</span> taludes_bien <span class="sc">|&gt;</span>    </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">biomasa =</span> Biomasa, <span class="co"># nombre nuevo = nombre viejo          </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">nivel_luz =</span> Luz, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">agua_estival =</span> Agua)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>📝 Ajustar sangría de código: Ctrl + i; Reformatear código: Ctrl + Shift + a</p>
<p>📝 Usar espacios antes y después de <code>=</code> y después de <code>,</code> hace mucho más fácil identificar los argumentos de la función y, en general, todos los componentes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">25</span>) <span class="sc">/</span> <span class="dv">12</span>, <span class="at">trim =</span> <span class="fl">0.2</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.966805</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="at">mean=</span><span class="dv">50</span>,<span class="at">sd=</span><span class="dv">25</span>)<span class="sc">/</span><span class="dv">12</span>,<span class="at">trim=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.966805</code></pre>
</div>
</div>
</section>
</section>
<section id="funciones-básicas-de-filtrado-y-selección" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="funciones-básicas-de-filtrado-y-selección"><span class="header-section-number">4</span> Funciones básicas de filtrado y selección</h2>
<section id="slice-filtrar-filas-según-el-índice-numérico" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="slice-filtrar-filas-según-el-índice-numérico"><span class="header-section-number">4.1</span> <a href="https://dplyr.tidyverse.org/reference/slice.html">Slice</a>: filtrar filas según el índice numérico</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="co"># shortcut para el pipe: CTRL + SHIFT + M </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  biomasa nivel_luz agua_estival  
    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;         
1    3.04 Nivel 1   Sequia estival</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  biomasa nivel_luz agua_estival  
    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;         
1    3.04 Nivel 1   Sequia estival
2    4.34 Nivel 1   Sequia estival</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  biomasa nivel_luz agua_estival  
    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;         
1    3.04 Nivel 1   Sequia estival
2    3.57 Nivel 1   Sequia estival
3    3.67 Nivel 1   Sequia estival
4    4.59 Nivel 1   Sequia estival
5    4.34 Nivel 1   Sequia estival
6    2.25 Nivel 1   Sequia estival</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 86 × 3
   biomasa nivel_luz agua_estival  
     &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;         
 1    2.25 Nivel 1   Sequia estival
 2    4.12 Nivel 1   Sequia estival
 3    2.45 Nivel 1   Sequia estival
 4    4.46 Nivel 1   Sequia estival
 5    3.51 Nivel 1   Sequia estival
 6    3.49 Nivel 1   Sequia estival
 7    2.80 Nivel 1   Sequia estival
 8    3.91 Nivel 1   Sequia estival
 9    3.16 Nivel 1   Sequia estival
10    3.81 Nivel 1   Sequia estival
# ℹ 76 more rows</code></pre>
</div>
</div>
</section>
<section id="arrange-ordenar-filas-por-los-valores-de-una-o-más-variables-columnas" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="arrange-ordenar-filas-por-los-valores-de-una-o-más-variables-columnas"><span class="header-section-number">4.2</span> <a href="https://dplyr.tidyverse.org/reference/arrange.html">Arrange</a>: ordenar filas por los valores de una o más variables (columnas)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(biomasa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 91 × 3
   biomasa nivel_luz agua_estival  
     &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;         
 1    2.12 Nivel 2   Lluvia estival
 2    2.25 Nivel 1   Sequia estival
 3    2.35 Nivel 3   Lluvia estival
 4    2.45 Nivel 1   Sequia estival
 5    2.49 Nivel 3   Lluvia estival
 6    2.54 Nivel 3   Lluvia estival
 7    2.70 Nivel 3   Lluvia estival
 8    2.73 Nivel 3   Lluvia estival
 9    2.80 Nivel 1   Sequia estival
10    2.86 Nivel 3   Lluvia estival
# ℹ 81 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(biomasa))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 91 × 3
   biomasa nivel_luz agua_estival  
     &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;         
 1    5.35 Nivel 3   Sequia estival
 2    5.30 Nivel 3   Sequia estival
 3    5.21 Nivel 1   Lluvia estival
 4    5.17 Nivel 2   Lluvia estival
 5    5.16 Nivel 1   Lluvia estival
 6    5.13 Nivel 2   Sequia estival
 7    5.10 Nivel 2   Lluvia estival
 8    5.06 Nivel 3   Sequia estival
 9    4.98 Nivel 2   Lluvia estival
10    4.94 Nivel 1   Lluvia estival
# ℹ 81 more rows</code></pre>
</div>
</div>
</section>
<section id="filter-filtrar-filas-utilizando-condiciones" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="filter-filtrar-filas-utilizando-condiciones"><span class="header-section-number">4.3</span> <a href="https://dplyr.tidyverse.org/reference/filter.html">Filter</a>: filtrar filas utilizando condiciones</h3>
<p>Se necesita un vector de filtrado que contenga valores lógicos (TRUE/FALSE).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nivel_luz <span class="sc">==</span> <span class="st">"Nivel 1"</span>) <span class="co"># filtrar por filas que cumplen un patrón </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 3
   biomasa nivel_luz agua_estival  
     &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;         
 1    3.04 Nivel 1   Sequia estival
 2    3.57 Nivel 1   Sequia estival
 3    3.67 Nivel 1   Sequia estival
 4    4.59 Nivel 1   Sequia estival
 5    4.34 Nivel 1   Sequia estival
 6    2.25 Nivel 1   Sequia estival
 7    4.12 Nivel 1   Sequia estival
 8    2.45 Nivel 1   Sequia estival
 9    4.46 Nivel 1   Sequia estival
10    3.51 Nivel 1   Sequia estival
# ℹ 20 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nivel_luz <span class="sc">==</span> <span class="st">"Nivel 1"</span> <span class="sc">&amp;</span> biomasa <span class="sc">&gt;</span> <span class="dv">4</span>) <span class="co"># combinar criterios: AND</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 3
   biomasa nivel_luz agua_estival  
     &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;         
 1    4.59 Nivel 1   Sequia estival
 2    4.34 Nivel 1   Sequia estival
 3    4.12 Nivel 1   Sequia estival
 4    4.46 Nivel 1   Sequia estival
 5    4.73 Nivel 1   Lluvia estival
 6    4.94 Nivel 1   Lluvia estival
 7    4.37 Nivel 1   Lluvia estival
 8    4.79 Nivel 1   Lluvia estival
 9    5.16 Nivel 1   Lluvia estival
10    4.55 Nivel 1   Lluvia estival
11    4.72 Nivel 1   Lluvia estival
12    4.23 Nivel 1   Lluvia estival
13    4.83 Nivel 1   Lluvia estival
14    4.48 Nivel 1   Lluvia estival
15    4.58 Nivel 1   Lluvia estival
16    5.21 Nivel 1   Lluvia estival</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nivel_luz <span class="sc">==</span> <span class="st">"Nivel 1"</span> <span class="sc">|</span> biomasa <span class="sc">&gt;</span> <span class="dv">5</span>) <span class="co"># combinar criterios: OR</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 3
   biomasa nivel_luz agua_estival  
     &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;         
 1    3.04 Nivel 1   Sequia estival
 2    3.57 Nivel 1   Sequia estival
 3    3.67 Nivel 1   Sequia estival
 4    4.59 Nivel 1   Sequia estival
 5    4.34 Nivel 1   Sequia estival
 6    2.25 Nivel 1   Sequia estival
 7    4.12 Nivel 1   Sequia estival
 8    2.45 Nivel 1   Sequia estival
 9    4.46 Nivel 1   Sequia estival
10    3.51 Nivel 1   Sequia estival
# ℹ 26 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nivel_luz <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Nivel 1"</span>, <span class="st">"Nivel 3"</span>)) <span class="co"># combinar criterios: %in% </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 3
   biomasa nivel_luz agua_estival  
     &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;         
 1    3.04 Nivel 1   Sequia estival
 2    3.57 Nivel 1   Sequia estival
 3    3.67 Nivel 1   Sequia estival
 4    4.59 Nivel 1   Sequia estival
 5    4.34 Nivel 1   Sequia estival
 6    2.25 Nivel 1   Sequia estival
 7    4.12 Nivel 1   Sequia estival
 8    2.45 Nivel 1   Sequia estival
 9    4.46 Nivel 1   Sequia estival
10    3.51 Nivel 1   Sequia estival
# ℹ 50 more rows</code></pre>
</div>
</div>
<section id="ejercicio" class="level4" data-number="4.3.1">
<h4 data-number="4.3.1" class="anchored" data-anchor-id="ejercicio"><span class="header-section-number">4.3.1</span> Ejercicio</h4>
<ul>
<li>Lee el data.frame “Macrobenthos.txt”. Pista: el delimitador entre datos es el tabulador (“\t”). <!--# No sale bien el simbolo --></li>
</ul>
<p>💡“Macrobenthos.txt” es una base de datos sobre la abundancia de distintos grupos taxonómicos de macroinvertebrados marinos (<a href="https://link.springer.com/book/10.1007/978-0-387-93837-0">Zuur et al.&nbsp;2009</a>).</p>
<ul>
<li><p>Crea un subset de datos que contenga las filas de la 1 a la 10 y de la 390 a la 400.</p></li>
<li><p>De la tabla original, crea un subset que NO contenga el Taxon número 1. Pista: revisa los <a href="https://bookdown.org/jboscomendoza/r-principiantes4/operadores-relacionales.html">operadores de R</a>.</p></li>
<li><p>Crea un subset con las observaciones del Taxon 2 donde se haya registrado una abundancia mayor de 50 o menor o igual a 5. Pista: necesitarás paréntesis para filtrar. ¿Cuántas filas han quedado?</p></li>
</ul>
</section>
</section>
<section id="select-seleccionar-columnas-utilizando-condiciones" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="select-seleccionar-columnas-utilizando-condiciones"><span class="header-section-number">4.4</span> <a href="https://dplyr.tidyverse.org/reference/select.html">Select</a>: seleccionar columnas utilizando condiciones</h3>
<p>Se necesita un vector de selección que contenga valores lógicos (TRUE/FALSE).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(biomasa, agua_estival)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 91 × 2
   biomasa agua_estival  
     &lt;dbl&gt; &lt;fct&gt;         
 1    3.04 Sequia estival
 2    3.57 Sequia estival
 3    3.67 Sequia estival
 4    4.59 Sequia estival
 5    4.34 Sequia estival
 6    2.25 Sequia estival
 7    4.12 Sequia estival
 8    2.45 Sequia estival
 9    4.46 Sequia estival
10    3.51 Sequia estival
# ℹ 81 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>?select <span class="co"># operators y selection helpers</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"a"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 91 × 2
   biomasa agua_estival  
     &lt;dbl&gt; &lt;fct&gt;         
 1    3.04 Sequia estival
 2    3.57 Sequia estival
 3    3.67 Sequia estival
 4    4.59 Sequia estival
 5    4.34 Sequia estival
 6    2.25 Sequia estival
 7    4.12 Sequia estival
 8    2.45 Sequia estival
 9    4.46 Sequia estival
10    3.51 Sequia estival
# ℹ 81 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># se pueden utilizar todo tipo de patrones de texto: https://rstudio.github.io/cheatsheets/strings.pdf</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nivel_luz, <span class="fu">everything</span>()) <span class="co"># se puede usar para reordenar variables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 91 × 3
   nivel_luz biomasa agua_estival  
   &lt;fct&gt;       &lt;dbl&gt; &lt;fct&gt;         
 1 Nivel 1      3.04 Sequia estival
 2 Nivel 1      3.57 Sequia estival
 3 Nivel 1      3.67 Sequia estival
 4 Nivel 1      4.59 Sequia estival
 5 Nivel 1      4.34 Sequia estival
 6 Nivel 1      2.25 Sequia estival
 7 Nivel 1      4.12 Sequia estival
 8 Nivel 1      2.45 Sequia estival
 9 Nivel 1      4.46 Sequia estival
10 Nivel 1      3.51 Sequia estival
# ℹ 81 more rows</code></pre>
</div>
</div>
<section id="ejercicio-1" class="level4" data-number="4.4.1">
<h4 data-number="4.4.1" class="anchored" data-anchor-id="ejercicio-1"><span class="header-section-number">4.4.1</span> Ejercicio</h4>
<ul>
<li><p>Con el data.frame “Macrobenthos.txt”, crea un nuevo data.frame que contenga las variables relacionadas con el medio (de <em>organic matter</em> a <em>temperature</em>). Pista: mira la ayuda de select para ahorrar caracteres.</p></li>
<li><p>Crea un nuevo objeto con el taxon al principio y que incluya las demás columnas excepto el esfuerzo de muestreo (<em>effort</em>).</p></li>
</ul>
</section>
</section>
</section>
<section id="transformar-los-datos-y-calcular-nuevas-variables" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="transformar-los-datos-y-calcular-nuevas-variables"><span class="header-section-number">5</span> Transformar los datos y calcular nuevas variables</h2>
<section id="mutate-crear-modificar-o-eliminar-columnas" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="mutate-crear-modificar-o-eliminar-columnas"><span class="header-section-number">5.1</span> <a href="https://dplyr.tidyverse.org/reference/mutate.html">Mutate</a>: crear, modificar o eliminar columnas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># definir una variable desde cero</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(taludes_bien), </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">supervivencia =</span> <span class="fu">as.factor</span>(<span class="fu">sample</span>(</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="fu">nrow</span>(taludes_bien),</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">replace =</span> <span class="cn">TRUE</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># utilizar una variable para calcular otra</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">carbono =</span> biomasa <span class="sc">*</span> <span class="fu">rnorm</span>(</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="fu">nrow</span>(taludes_bien),</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="fl">0.4</span>,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> <span class="fl">0.2</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 91 × 6
      ID biomasa nivel_luz agua_estival   supervivencia carbono
   &lt;int&gt;   &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;          &lt;fct&gt;           &lt;dbl&gt;
 1     1    3.04 Nivel 1   Sequia estival 0               0.931
 2     2    3.57 Nivel 1   Sequia estival 1               0.877
 3     3    3.67 Nivel 1   Sequia estival 0               3.05 
 4     4    4.59 Nivel 1   Sequia estival 1               0.611
 5     5    4.34 Nivel 1   Sequia estival 1               2.17 
 6     6    2.25 Nivel 1   Sequia estival 0               1.46 
 7     7    4.12 Nivel 1   Sequia estival 0               2.17 
 8     8    2.45 Nivel 1   Sequia estival 0               1.18 
 9     9    4.46 Nivel 1   Sequia estival 0               2.49 
10    10    3.51 Nivel 1   Sequia estival 1               1.30 
# ℹ 81 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sobreescribir una variable. En concreto fct_recode </span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sirve para redefinir los niveles de un factor</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">agua_estival =</span> <span class="fu">fct_recode</span>(</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>      agua_estival, <span class="at">sequia =</span> <span class="st">"Sequia estival"</span>, <span class="at">lluvia =</span> <span class="st">"Lluvia estival"</span>),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">nivel_luz =</span> <span class="fu">fct_recode</span>(</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>      nivel_luz,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Nivel 1"</span>,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Nivel 2"</span>,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Nivel 3"</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 91 × 3
   biomasa nivel_luz agua_estival
     &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;       
 1    3.04 1         sequia      
 2    3.57 1         sequia      
 3    3.67 1         sequia      
 4    4.59 1         sequia      
 5    4.34 1         sequia      
 6    2.25 1         sequia      
 7    4.12 1         sequia      
 8    2.45 1         sequia      
 9    4.46 1         sequia      
10    3.51 1         sequia      
# ℹ 81 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>taludes_bien <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># utilizar varias variables para calcular otra nueva</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">estres =</span> <span class="fu">case_when</span>(</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># "Si el nivel de luz es 1 y hay sequia, el estrés será alto"</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>      nivel_luz <span class="sc">==</span> <span class="st">"Nivel 1"</span> <span class="sc">&amp;</span> agua_estival <span class="sc">==</span> <span class="st">"Sequia estival"</span> <span class="sc">~</span> <span class="st">"alto"</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>      nivel_luz <span class="sc">==</span> <span class="st">"Nivel 3"</span> <span class="sc">&amp;</span> agua_estival <span class="sc">==</span> <span class="st">"Lluvia estival"</span> <span class="sc">~</span> <span class="st">"bajo"</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"intermedio"</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 91 × 4
   biomasa nivel_luz agua_estival   estres
     &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;          &lt;chr&gt; 
 1    3.04 Nivel 1   Sequia estival alto  
 2    3.57 Nivel 1   Sequia estival alto  
 3    3.67 Nivel 1   Sequia estival alto  
 4    4.59 Nivel 1   Sequia estival alto  
 5    4.34 Nivel 1   Sequia estival alto  
 6    2.25 Nivel 1   Sequia estival alto  
 7    4.12 Nivel 1   Sequia estival alto  
 8    2.45 Nivel 1   Sequia estival alto  
 9    4.46 Nivel 1   Sequia estival alto  
10    3.51 Nivel 1   Sequia estival alto  
# ℹ 81 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># repetimos todo lo anterior concatenando todo el proceso:</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>taludes_trans <span class="ot">&lt;-</span> taludes_bien <span class="sc">|&gt;</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(taludes_bien),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">supervivencia =</span> <span class="fu">as.factor</span>(<span class="fu">sample</span>(</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fu">nrow</span>(taludes_bien),</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>),</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">TRUE</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  )),</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">carbono =</span> biomasa <span class="sc">*</span> <span class="fu">rnorm</span>(</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">nrow</span>(taludes_bien),</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fl">0.4</span>,</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fl">0.2</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">agua_estival =</span> <span class="fu">fct_recode</span>(agua_estival, <span class="at">sequia =</span> <span class="st">"Sequia estival"</span>, <span class="at">lluvia =</span> <span class="st">"Lluvia estival"</span>),</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">nivel_luz =</span> <span class="fu">fct_recode</span>(</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>      nivel_luz,</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Nivel 1"</span>,</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Nivel 2"</span>,</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Nivel 3"</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">estres =</span> <span class="fu">case_when</span>(</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>      nivel_luz <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>        agua_estival <span class="sc">==</span> <span class="st">"sequia"</span> <span class="sc">~</span> <span class="st">"alto"</span>,</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>      nivel_luz <span class="sc">==</span> <span class="dv">3</span> <span class="sc">&amp;</span></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>        agua_estival <span class="sc">==</span> <span class="st">"lluvia"</span> <span class="sc">~</span> <span class="st">"bajo"</span>,</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"intermedio"</span></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="ejercicio-2" class="level4" data-number="5.1.1">
<h4 data-number="5.1.1" class="anchored" data-anchor-id="ejercicio-2"><span class="header-section-number">5.1.1</span> Ejercicio</h4>
<ul>
<li>Con el data.frame macrobenthos genera una nueva columna con la relación (división) entre la turbidez del agua y la materia orgánica.</li>
</ul>
</section>
</section>
<section id="summarise-y-group-by-generar-un-nuevo-data.frame-resumiendo-cada-grupo-a-una-fila" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="summarise-y-group-by-generar-un-nuevo-data.frame-resumiendo-cada-grupo-a-una-fila"><span class="header-section-number">5.2</span> <a href="https://dplyr.tidyverse.org/reference/summarise.html">Summarise</a> y <a href="https://dplyr.tidyverse.org/reference/group_by.html">group by</a>: generar un nuevo <code>data.frame</code> resumiendo cada grupo a una fila</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>taludes_trans <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">c_min =</span> <span class="fu">min</span>(carbono),</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">c_max =</span> <span class="fu">max</span>(carbono))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  c_min c_max
  &lt;dbl&gt; &lt;dbl&gt;
1 0.165  3.86</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>taludes_trans <span class="sc">|&gt;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(estres) <span class="sc">|&gt;</span>  </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">biomasa_min =</span> <span class="fu">min</span>(biomasa),</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">biomasa_mean =</span> <span class="fu">mean</span>(biomasa),</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">biomasa_max =</span> <span class="fu">max</span>(biomasa))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  estres     biomasa_min biomasa_mean biomasa_max
  &lt;chr&gt;            &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
1 alto              2.25         3.51        4.59
2 bajo              2.35         3.30        4.58
3 intermedio        2.12         4.32        5.35</code></pre>
</div>
</div>
<section id="ejercicio-3" class="level4" data-number="5.2.1">
<h4 data-number="5.2.1" class="anchored" data-anchor-id="ejercicio-3"><span class="header-section-number">5.2.1</span> Ejercicio</h4>
<ul>
<li><p>Con el data.frame macrobenthos, cuenta el número de casos que hay en cada periodo de muestreo.</p></li>
<li><p>Cuenta el número de casos distintos que hay de esfuerzo de muestreo.</p></li>
<li><p>Calcula la media de la turbidez para cada taxón.</p></li>
</ul>
</section>
</section>
<section id="pivot-transformar-datos-a-formato-ancho-a-largo-y-viceversa" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="pivot-transformar-datos-a-formato-ancho-a-largo-y-viceversa"><span class="header-section-number">5.3</span> <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">Pivot</a>: transformar datos a formato ancho a largo y viceversa</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/tidy_pivot_longer.png" class="img-fluid figure-img"></p>
<figcaption>La variable año está dividida en dos columnas y cada fila representa dos observaciones no una. Extraido de <a href="https://r4ds.had.co.nz/tidy-data.html">R for Data Science</a>.</figcaption>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>stocks <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">year   =</span> <span class="fu">c</span>(<span class="dv">2015</span>, <span class="dv">2015</span>, <span class="dv">2016</span>, <span class="dv">2016</span>),</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">half  =</span> <span class="fu">c</span>(   <span class="dv">1</span>,    <span class="dv">2</span>,     <span class="dv">1</span>,    <span class="dv">2</span>),</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">return =</span> <span class="fu">c</span>(<span class="fl">1.88</span>, <span class="fl">0.59</span>, <span class="fl">0.92</span>, <span class="fl">0.17</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>stocks <span class="sc">|&gt;</span> </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> return) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
   half `2015` `2016`
  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     1   1.88   0.92
2     2   0.59   0.17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>stocks <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> return) <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">`</span><span class="at">2015</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2016</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">"year"</span>, <span class="at">values_to =</span> <span class="st">"return"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
   half year  return
  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1     1 2015    1.88
2     1 2016    0.92
3     2 2015    0.59
4     2 2016    0.17</code></pre>
</div>
</div>
</section>
</section>
<section id="joins-unir-data.frames" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="joins-unir-data.frames"><span class="header-section-number">6</span> <a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">Joins</a>: unir data.frames</h2>
<p><code>*_join()</code> añade columnas de <code>y</code> (segundo data.frame) a <code>x</code> (primer data.frame), haciendo coincidir las observaciones en función de la variable común.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-920719998.png" class="img-fluid figure-img" width="250"></p>
<figcaption>Tipos de uniones. Extraido del <a href="https://nyu-cdsc.github.io/learningr/assets/data-transformation.pdf">Cheat sheet de dplyr</a>.</figcaption>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># join: left, right, full, inner</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>bloques <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(taludes_trans), </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">bloque =</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">size =</span> <span class="fu">nrow</span>(taludes_trans), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>taludes_trans <span class="ot">&lt;-</span> taludes_trans <span class="sc">|&gt;</span> </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(bloques) <span class="sc">|&gt;</span> </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, bloque, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="write_delim-guardar-datos" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="write_delim-guardar-datos"><span class="header-section-number">7</span> <a href="https://readr.tidyverse.org/reference/write_delim.html">Write_delim</a>: guardar datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_delim</span>(taludes_trans, <span class="at">file =</span> <span class="st">"taludes_trans.csv"</span>, <span class="at">delim =</span> <span class="st">";"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># en file hay que especificar el directorio donde queremos que se guarde. Si no, se guardará en el directorio de trabajo (getwd())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="enlaces-de-interés-sobre-manipulación-de-datos" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="enlaces-de-interés-sobre-manipulación-de-datos"><span class="header-section-number">8</span> Enlaces de interés sobre manipulación de datos</h2>
<ul>
<li><p><a href="https://nyu-cdsc.github.io/learningr/assets/data-transformation.pdf">Cheat sheet de dplyr</a></p></li>
<li><p><a href="https://r4ds.had.co.nz/transform.html">R for data Science (Data transformation)</a></p></li>
<li><p><a href="https://www.tidyverse.org">Página web de <em>tidyverse</em></a></p></li>
<li><p><a href="http://adv-r.had.co.nz/Style.html">Style guide</a></p></li>
</ul>
</section>
<section id="introducción-a-la-programación-funcional" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="introducción-a-la-programación-funcional"><span class="header-section-number">9</span> Introducción a la programación funcional</h2>
<p>La creciente disponibilidad de datos y de versatilidad de los programas de análisis han provocado el incremento en la cantidad y complejidad de los análisis que realizamos. Esto hace cada vez más necesaria la eficiencia en el proceso de gestión y análisis de datos. Una de las posibles formas para optimizar estos procesos y acortar los tiempos de trabajo para los usuarios de R es la programación basada en funciones. Las funciones permiten automatizar tareas comunes (por ejemplo, leer diferentes bases de datos) simplificando el código.</p>
<p>Como las funciones en R son objetos, es posible llamarlas a través de otras funciones e iterar este proceso, lo que constituye la base de la programación funcional y convierte a R en una herramienta muy poderosa. Las iteraciones sirven para realizar la misma acción a múltiples entradas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("palmerpenguins")</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> penguins <span class="sc">|&gt;</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>df_rescaled1 <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">bill_length_mm =</span> (bill_length_mm <span class="sc">-</span> <span class="fu">min</span>(bill_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> (</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(bill_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(bill_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">bill_depth_mm =</span> (bill_depth_mm <span class="sc">-</span> <span class="fu">min</span>(bill_depth_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> (</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(bill_depth_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(bill_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">flipper_length_mm =</span> (flipper_length_mm <span class="sc">-</span> <span class="fu">min</span>(flipper_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> (</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(flipper_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(flipper_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">body_mass_g =</span> (body_mass_g <span class="sc">-</span> <span class="fu">min</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> (<span class="fu">max</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(df_rescaled1)</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>rescale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { </span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)      </span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>df_rescaled2 <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">bill_length_mm =</span> <span class="fu">rescale01</span>(<span class="at">x =</span> bill_length_mm),</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">bill_depth_mm =</span> <span class="fu">rescale01</span>(<span class="at">x =</span> bill_depth_mm),</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">flipper_length_mm =</span> <span class="fu">rescale01</span>(<span class="at">x =</span> flipper_length_mm),</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">body_mass_g =</span> <span class="fu">rescale01</span>(<span class="at">x =</span> body_mass_g)</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(df_rescaled2)</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>df_rescaled3 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, rescale01)</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(df_rescaled3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Las principales <strong>ventajas de la programación funcional</strong> (uso de funciones e iteraciones) son:</p>
<ul>
<li>Facilidad para ver la intención del código y, por tanto, mejorar la <strong>comprensión</strong> para uno mismo, colaboradores y revisores:
<ul>
<li>Las funciones tienen un nombre evocativo.</li>
<li>El código queda más ordenado.</li>
</ul></li>
<li><strong>Rapidez</strong> si se necesitan hacer cambios ya que las funciones son piezas independientes que resuelven un problema concreto.</li>
<li><strong>Disminuye la probabilidad de error</strong>.</li>
</ul>
<section id="cuándo-hay-que-usar-una-función" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="cuándo-hay-que-usar-una-función"><span class="header-section-number">9.1</span> ¿Cuándo hay que usar una función?</h3>
<p>Se recomienda seguir el principio “do not repeat yourself” (<a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself#:~:text=%22Don't%20repeat%20yourself%22,redundancy%20in%20the%20first%20place.">DRY principle</a>): cada unidad de conocimiento o información debe tener una representación única, inequívoca y autoritativa en un sistema.</p>
<p>Escribir una función ya merece la pena cuando has copiado y pegado más de dos veces lo mismo (don’t be WET! - Write Everything Twice). Cuantas más veces esté repetido un código, en más sitios necesitarás actualizarlo si hay algun cambio y más aumenta la probabilidad de error.</p>
</section>
</section>
<section id="teoría-sobre-funciones-en-r" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="teoría-sobre-funciones-en-r"><span class="header-section-number">10</span> Teoría sobre funciones en R</h2>
<p>Según el tipo de output generado (última expresión ejecutada dentro de la función) hay dos tipos de funciones:</p>
<ul>
<li><p>Las <strong>funciones de transformación</strong> transforman el objeto que entra en la función (primer argumento) y devuelven otro objeto o el anterior modificado. Los funcionales son tipos especiales de funciones de transformación.</p>
<p><img src="images/function.png" class="img-fluid"></p></li>
<li><p>Las <strong>funciones secundarias</strong> (<em>side-effect functions</em>) tienen efectos colaterales y ejecutan una acción, como guardar un archivo o dibujar un plot. Algunos ejemplos de funciones secundarias que se usan comunmente son: <code>library()</code>, <code>setwd()</code>, <code>plot()</code>, <code>write_delim()</code>… Estas funciones retornan <em>de forma invisible</em> el primer argumento, que no se guarda, pero puede ser usado en un <em>pipeline</em>.</p></li>
</ul>
<p>En general, sintácticamente, las funciones tienen tres componentes:</p>
<ul>
<li>Función <code>function()</code></li>
<li>Argumentos: lista de entradas.</li>
<li>Cuerpo: trozo de código que sigue a <code>function()</code>, tradicionalmente entre llaves.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>nombre1_v1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(x, y, <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>nombre1_v2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) <span class="fu">paste</span>(x, y, <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>nombre1_v3 <span class="ot">&lt;-</span> \(x, y) <span class="fu">paste</span>(x, y, <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="fu">nombre1_v1</span>(<span class="st">"Vero"</span>, <span class="st">"Cruz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Vero_Cruz"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nombre1_v2</span>(<span class="st">"Vero"</span>, <span class="st">"Cruz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Vero_Cruz"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nombre1_v3</span>(<span class="st">"Vero"</span>, <span class="st">"Cruz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Vero_Cruz"</code></pre>
</div>
</div>
<p>📝 Si la función tiene más de dos lineas es mejor usar llaves siempre para que quede bien delimitada. La llave de apertura nunca debe ir sola pero sí la de cierre (excepto con <em>else</em>). Las sangrías también ayudan mucho a entender la jerarquía del código dentro de las funciones.</p>
<p>En general las funciones tienen un nombre que se ejecuta cuando se necesita como hemos visto hasta ahora, pero esto no es obligatorio. Algunos paquetes como {purrr} o las funciones de la familia <code>apply</code> permiten el uso de <strong>funciones anónimas</strong> para iterar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(penguins, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(x)))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$species
[1] 3

$island
[1] 3

$bill_length_mm
[1] 165

$bill_depth_mm
[1] 81

$flipper_length_mm
[1] 56

$body_mass_g
[1] 95

$sex
[1] 3

$year
[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span>    </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$species
[1] 3

$island
[1] 3

$bill_length_mm
[1] 165

$bill_depth_mm
[1] 81

$flipper_length_mm
[1] 56

$body_mass_g
[1] 95

$sex
[1] 3

$year
[1] 3</code></pre>
</div>
</div>
<p>📝 Mejor reservar el uso de funciones anónimas para funciones cortas y simples. Si la función es larga, ocupa varias líneas o tenemos que usarla con frecuencia mejor darle un nombre.</p>
</section>
<section id="sec-writefun" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="sec-writefun"><span class="header-section-number">11</span> Cómo escribir funciones</h2>
<section id="ejercicio-4" class="level4" data-number="11.0.1">
<h4 data-number="11.0.1" class="anchored" data-anchor-id="ejercicio-4"><span class="header-section-number">11.0.1</span> Ejercicio</h4>
<p>Genera tu primera función que divida un valor siempre entre 100.</p>
<p>💡Atajo para escribir funciones: escribir la palabra fun + tabulador</p>
<p>Imaginad que para un set de datos quisieramos hacer un gráfico de distribución de cada variable numérica, en función de otra variable categórica que nos interese especialmente, para ver cómo se distribuye.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>penguins_num <span class="ot">&lt;-</span> penguins <span class="sc">|&gt;</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(species, sex, <span class="fu">where</span>(is.numeric))  <span class="co"># nos interesan las diferencias entre especie y sexo</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_num, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> bill_length_mm, <span class="at">color =</span> sex)) <span class="sc">+</span>     <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitterdodge</span>(), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"turquoise"</span>, <span class="st">"goldenrod1"</span>)) <span class="sc">+</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dia_2_datos_programacion_files/figure-html/codigo_repetido_avanzado-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_num, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> bill_depth_mm, <span class="at">color =</span> sex)) <span class="sc">+</span>   <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitterdodge</span>(), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"turquoise"</span>, <span class="st">"goldenrod1"</span>)) <span class="sc">+</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dia_2_datos_programacion_files/figure-html/codigo_repetido_avanzado-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_num, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> flipper_length_mm, <span class="at">color =</span> sex)) <span class="sc">+</span>   <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitterdodge</span>(), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"turquoise"</span>, <span class="st">"goldenrod1"</span>)) <span class="sc">+</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()  <span class="co"># etc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dia_2_datos_programacion_files/figure-html/codigo_repetido_avanzado-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hemos copiado un código más de dos veces para realizar una misma acción (es decir, un gráfico para ver como se distribuye una variable en función de otras dos que se mantienen constantes) así que hay que considerar la posibilidad de que estemos necesitando una función. A continuación vamos a seguir unos <strong>sencillos pasos para transformar cualquier código repetido en función</strong>.</p>
<ol type="1">
<li><p>Analizar el código: ¿cuáles son las partes replicadas? ¿cuantas entradas tenemos? ¿cuáles varían y cuáles no?</p></li>
<li><p>Simplificar y reanalizar duplicaciones</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> penguins_num<span class="sc">$</span>bill_length_mm  </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_num, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> var, <span class="at">color =</span> sex)) <span class="sc">+</span>   </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitterdodge</span>(), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span>   </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>   </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"turquoise"</span>, <span class="st">"goldenrod1"</span>)) <span class="sc">+</span>   </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dia_2_datos_programacion_files/figure-html/funcion_simplificar-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> body_mass_g </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'body_mass_g' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> <span class="st">"body_mass_g"</span>  </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_num, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> var, <span class="at">color =</span> sex)) <span class="sc">+</span>   </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitterdodge</span>(), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span>   </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>   </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"turquoise"</span>, <span class="st">"goldenrod1"</span>)) <span class="sc">+</span>   </span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span>   </span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(var) <span class="co"># grafico erroneo  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dia_2_datos_programacion_files/figure-html/funcion_simplificar_2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_num, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> .data[[var]], <span class="at">color =</span> sex)) <span class="sc">+</span>   </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitterdodge</span>(), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span>   </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>   </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"turquoise"</span>, <span class="st">"goldenrod1"</span>)) <span class="sc">+</span>   </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span>   </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(var) <span class="co"># grafico correcto</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dia_2_datos_programacion_files/figure-html/funcion_simplificar_2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>👀 La función <code>ggplot</code> necesita argumentos (data-variable) que estén dentro del <code>data.frame</code> que va a representar. Para poder generalizar la función hemos guardado el nombre de la variable en un objeto (tipo <code>character</code>), pero <code>ggplot</code> no acepta <code>characters</code>. Por ello necesitamos utilizar una función intermedia que sí los acepte. Para resolver problemas comunes de programación funcional derivados de la <em>non-standard evaluation</em> de <em>tidyverse</em> <a href="https://dplyr.tidyverse.org/articles/programming.html#introduction">mira este enlace</a>.</p>
<ol start="3" type="1">
<li><p>Elegir un nombre para la función (📝). Idealmente tiene que ser corto y evocar lo que la función hace. En general, debe ser un verbo (p.&nbsp;ej. imputar_valores) mientras que los argumentos son sustantivos (p.&nbsp;ej. data, variable, etc.). Usar un sustantivo para una función está permitido si la función calcula algo muy conocido (p.&nbsp;ej. <code>mean()</code>) o si sirve para acceder a partes de un objeto (p.&nbsp;ej. <code>residuals()</code>). También se recomienda evitar verbos muy genéricos (p.&nbsp;ej. calcular) y si el nombre tiene varias palabras separarlas con guión bajo o mayúsculas, pero ser consistente. Si programas varias funciones que hacen cosas parecidas se recomienda usar el mismo prefijo para todas (p.&nbsp;ej. “str_” en el paquete {stringr}).</p></li>
<li><p>Enumerar los argumentos dentro de <code>function()</code> y poner el código simplificado dentro de las llaves.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>explorar_penguins <span class="ot">&lt;-</span> <span class="cf">function</span> (var) {</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(penguins_num, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> .data[[var]], <span class="at">color =</span> sex)) <span class="sc">+</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitterdodge</span>(), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span>     </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>     </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"turquoise"</span>, <span class="st">"goldenrod1"</span>)) <span class="sc">+</span>     </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span>     </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(var)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>📝 Utiliza comentarios (#) para explicar el razonamiento detrás de tus funciones. Se debe evitar explicar qué se está haciendo o cómo, ya que el propio código ya lo comunica. También se recomienda usar # para separar apartados (Cmd/Ctrl + Shift + R).</p>
<ol start="5" type="1">
<li>Probar la función con entradas diferentes</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">explorar_penguins</span>(<span class="at">var =</span> <span class="st">"body_mass_g"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dia_2_datos_programacion_files/figure-html/funcion_pruebas-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">explorar_penguins</span>(<span class="at">var =</span> <span class="st">"flipper_length_mm"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_boxplot()`).
Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dia_2_datos_programacion_files/figure-html/funcion_pruebas-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">explorar_penguins</span>(<span class="at">var =</span> <span class="st">"bill_depth_mm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_boxplot()`).
Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dia_2_datos_programacion_files/figure-html/funcion_pruebas-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ejercicio-5" class="level4" data-number="11.0.2">
<h4 data-number="11.0.2" class="anchored" data-anchor-id="ejercicio-5"><span class="header-section-number">11.0.2</span> Ejercicio</h4>
<p>Genera una función para estandarizar (es decir, restar la media y dividir por la desviación típica) las variables numéricas de penguins.</p>
</section>
<section id="argumentos" class="level3" data-number="11.1">
<h3 data-number="11.1" class="anchored" data-anchor-id="argumentos"><span class="header-section-number">11.1</span> Argumentos</h3>
<p>En general hay dos grupos: los que especifican los <strong>datos</strong> y los que especifican <strong>detalles</strong> de la ejecución de la función. Normalmente los que especifican datos se colocan primero y los de detalle después. Estos últimos suelen tener valores por defecto (los más comunes), para cuando no se especifique nada.</p>
<!--# Ver ayuda de quantile -->
<p>📝 Los nombres de los argumentos deben ser cortos y descriptivos. Hay algunos comunes pero poco descriptivos que ya son conocidos para la mayoría de los usuarios y está bien aprovecharlos:</p>
<p><code>x, y, z</code>: vectores</p>
<p><code>w</code>: vector de pesos</p>
<p><code>df</code>: data frame</p>
<p><code>i, j</code>: indices numericos, filas y columnas respectivamente</p>
<p><code>n</code>: longitud o número de filas</p>
<p><code>p</code>: numero de columnas</p>
<p><code>na.rm</code>: valores faltantes</p>
</section>
</section>
<section id="iteraciones-con-bucles-for" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="iteraciones-con-bucles-for"><span class="header-section-number">12</span> Iteraciones con bucles <em>for</em></h2>
<p>Los bucles son recomendables para adentrarse en el mundo de las iteraciones porque hacen cada iteración muy explícita para que quede claro lo que está pasando.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/forloops.png" class="img-fluid figure-img"></p>
<figcaption>Representación gráfica del funcionamiento de los bucles for donde se ve claramente que se está realizando una iteración. Ilustración de Allison Horst obtenido de la charla de Hadley Wickham The Joy of Functional Programming (para ciencia de datos)</figcaption>
</figure>
</div>
<p>Para programar un bucle es necesario definir tres partes diferentes: la salida, la secuencia y el cuerpo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>df_ej <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">a =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">b =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">c =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) )  </span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>salida <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"double"</span>, <span class="dv">3</span>)           <span class="co"># 1. salida </span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {                        <span class="co"># 2. secuencia   </span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>  salida[[i]] <span class="ot">&lt;-</span> <span class="fu">first</span>(df_ej[[i]])      <span class="co"># 3. cuerpo </span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>salida  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 3 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># podriamos generalizar el for </span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>salida <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"double"</span>, <span class="fu">ncol</span>(df_ej))   <span class="co"># 1. salida </span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(df_ej)) {             <span class="co"># 2. secuencia   </span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  salida[[i]] <span class="ot">&lt;-</span> <span class="fu">first</span>(df_ej[[i]])        <span class="co"># 3. cuerpo </span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>salida  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 3 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tambien podriamos iterar sobre filas </span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>salida <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"double"</span>, <span class="fu">nrow</span>(df_ej))  </span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df_ej)) {     </span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  salida[[i]] <span class="ot">&lt;-</span> <span class="fu">sum</span>(df_ej[i, ]) </span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>salida</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  8  6  8 13 10</code></pre>
</div>
</div>
<ol type="1">
<li><p>Salida: aquí determinamos el espacio de la salida, es decir, primero tenemos que crear la libreta donde vamos a ir apuntando todos los resultados.</p></li>
<li><p>Secuencia: aquí determinamos sobre lo que queremos iterar. Cada ejecución del bucle <em>for</em> asignará un valor diferente de <code>seq_along(y)</code> a <code>i</code>.</p></li>
<li><p>Cuerpo: aquí determinamos lo que queremos que haga cada iteración. Se ejecuta repetidamente, cada vez con un valor diferente para <code>i</code>.</p></li>
</ol>
<p>Existe la creencia de que los bucles <em>for</em> son lentos, pero la desventaja real de <em>los bucles for es que son demasiado flexibles</em> y pueden realizar muchas tareas diferentes. En cambio, cada funcional ({<a href="https://purrr.tidyverse.org/">purrr</a>}, <a href="https://www.r-bloggers.com/2022/03/complete-tutorial-on-using-apply-functions-in-r/"><code>apply</code></a>) está diseñado para una tarea específica, por lo que en cuanto lo ves en el código, inmediatamente sabes por qué se está utilizando. Es decir, la principal ventaja es su claridad al hacer que el código sea más fácil de escribir y de leer.</p>
<p>Los bucles pueden ser más explícitos en cuanto a que se ve claramente la iteración, pero se necesita más tiempo para entender qué se está haciendo. Por el contrario, los funcionales necesitan un paso más de abstracción. Lo más importante es que soluciones el problema y poco a poco ir escribiendo código cada vez más sencillo y elegante.</p>
</section>
<section id="iteraciones-con-funcionales" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="iteraciones-con-funcionales"><span class="header-section-number">13</span> Iteraciones con funcionales</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/map_frosting.png" class="img-fluid figure-img"></p>
<figcaption>Representación gráfica del funcionamiento de map() donde el foco está en la operación realizada. Ilustración de Allison Horst obtenido de la charla de Hadley Wickham The Joy of Functional Programming (para ciencia de datos)</figcaption>
</figure>
</div>
<p>Un funcional es una función que toma una función como entrada y devuelve un vector u otro tipo de objeto como salida.</p>
<p>Para programar un funcional, primero, solucionamos el problema para un elemento. Después, generamos una función que nos permita envolver la solución en una función (como lo hicimos en <a href="#sec-writefun" class="quarto-xref">Section&nbsp;11</a>). Por último, <em>aplicamos la función a todos los elementos que estamos interesados.</em> Es decir, dividimos los problemas grandes en problemas más pequeños y resolvemos cada tarea con una o más funciones.</p>
<p>En <em>tidyverse</em> se iteran procesos mediante el paquete {purrr}. Comparando los funcionales con los bucles, el foco está en la operación que se está ejecutando, y no en el código necesario para iterar sobre cada elemento y guardar la salida.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(df_ej, first)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
[1] 3

$b
[1] 3

$c
[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>df_ej <span class="sc">|&gt;</span>    </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(first)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
[1] 3

$b
[1] 3

$c
[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>salida <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="at">length =</span> <span class="dv">3</span>) </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {   </span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  salida[[i]] <span class="ot">&lt;-</span> <span class="fu">first</span>(df_ej[[i]]) </span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>salida</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 3

[[2]]
[1] 3

[[3]]
[1] 2</code></pre>
</div>
</div>
<section id="nuestro-primer-funcional-generando-listas-map" class="level3" data-number="13.1">
<h3 data-number="13.1" class="anchored" data-anchor-id="nuestro-primer-funcional-generando-listas-map"><span class="header-section-number">13.1</span> Nuestro primer funcional: generando listas, <code>map()</code></h3>
<p><code>map_*()</code> está vectorizado sobre un argumento, p.&nbsp;ej. <code>(x)</code>. La función operará en todos los elementos de <code>x</code>, es decir, cada valor si <code>x</code> es un vector, cada columna si <code>x</code> es un <code>data.frame</code>, o cada elemento si <code>x</code> es una lista.</p>
<p>Toma un vector y una función, llama a la función una vez por cada elemento del vector y devuelve los resultados en una lista. <code>map(1:3, f)</code> es equivalente a <code>list(f(1), f(2), f(3))</code>. Es el equivalente de <code>lapply()</code> de R base.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>cuadratica <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {   </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">^</span> <span class="dv">2</span> </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>map_ouput_list <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">.f =</span> cuadratica)  </span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>lapply_ouput_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="at">X =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">FUN =</span> cuadratica)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/map.png" class="img-fluid"></p>
<section id="ejercicio-6" class="level4" data-number="13.1.1">
<h4 data-number="13.1.1" class="anchored" data-anchor-id="ejercicio-6"><span class="header-section-number">13.1.1</span> Ejercicio</h4>
<p>Generad un vector, una función y aplicadle la función a cada uno de los elementos del vector utilizando <code>map()</code>.</p>
<p>Los argumentos que varían para cada ejecución se ponen antes de la función y los argumentos que son los mismos para cada ejecución se ponen después (p.&nbsp;ej. <code>na.rm = T</code>).</p>
<p><img src="images/map+fix.png" class="img-fluid"></p>
</section>
</section>
<section id="nuestro-segundo-funcional-generando-vectores-y-data.frames-map_" class="level3" data-number="13.2">
<h3 data-number="13.2" class="anchored" data-anchor-id="nuestro-segundo-funcional-generando-vectores-y-data.frames-map_"><span class="header-section-number">13.2</span> Nuestro segundo funcional: generando vectores y data.frames, <code>map_*()</code></h3>
<section id="ejercicio-7" class="level4" data-number="13.2.1">
<h4 data-number="13.2.1" class="anchored" data-anchor-id="ejercicio-7"><span class="header-section-number">13.2.1</span> Ejercicio</h4>
<p>Dedicadle un par de minutos a entender lo que hacen las siguientes funciones:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_df</span>(df_ej, first)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
      a     b     c
  &lt;int&gt; &lt;int&gt; &lt;int&gt;
1     3     3     2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_lgl</span>(penguins, is.numeric) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          species            island    bill_length_mm     bill_depth_mm 
            FALSE             FALSE              TRUE              TRUE 
flipper_length_mm       body_mass_g               sex              year 
             TRUE              TRUE             FALSE              TRUE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>penguins_num <span class="ot">&lt;-</span> penguins[ , <span class="fu">map_lgl</span>(penguins, is.numeric)]  </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(penguins_num, median, <span class="at">na.rm =</span> T) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   bill_length_mm     bill_depth_mm flipper_length_mm       body_mass_g 
            44.45             17.30            197.00           4050.00 
             year 
          2008.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_chr</span>(penguins, class) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          species            island    bill_length_mm     bill_depth_mm 
         "factor"          "factor"         "numeric"         "numeric" 
flipper_length_mm       body_mass_g               sex              year 
        "integer"         "integer"          "factor"         "integer" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_int</span>(penguins, \(x) <span class="fu">length</span>(<span class="fu">unique</span>(x))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          species            island    bill_length_mm     bill_depth_mm 
                3                 3               165                81 
flipper_length_mm       body_mass_g               sex              year 
               56                95                 3                 3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">|&gt;</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_vec</span>(\(x) <span class="fu">as.Date</span>(<span class="fu">ISOdate</span>(x <span class="sc">+</span> <span class="dv">2024</span>, <span class="dv">12</span>, <span class="dv">03</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-12-03" "2026-12-03" "2027-12-03" "2028-12-03"</code></pre>
</div>
</div>
</section>
</section>
<section id="enlaces-de-interés-sobre-programación-funcional" class="level3" data-number="13.3">
<h3 data-number="13.3" class="anchored" data-anchor-id="enlaces-de-interés-sobre-programación-funcional"><span class="header-section-number">13.3</span> Enlaces de interés sobre programación funcional</h3>
<ul>
<li><p><a href="https://github.com/DatSciR/intro_prog_fun/tree/main/lleida">Introducción a la programación funcional (DatSciR)</a></p></li>
<li><p><a href="https://r4ds.had.co.nz/functions.html">R for data Science (functions)</a></p></li>
<li><p><a href="https://adv-r.hadley.nz/functions.html">Advanced R (functions)</a></p></li>
<li><p><a href="https://r4ds.had.co.nz/iteration.html">R for data Science (iteration)</a></p></li>
<li><p><a href="https://adv-r.hadley.nz/functionals.html">Advanced R (functionals)</a></p></li>
<li><p><a href="https://www.tidyverse.org/blog/2022/12/purrr-1-0-0/">purrr 1.0.0</a></p></li>
<li><p><a href="https://www.rebeccabarter.com/blog/2019-08-19_purrr">Learn to purrr (Rebecca Barter)</a></p></li>
</ul>
<hr>
<details>
<summary>
Session Info
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2024-12-03 22:46:40 CET"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.2 (2024-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 22631)

Matrix products: default


locale:
[1] LC_COLLATE=English_United States.utf8 
[2] LC_CTYPE=English_United States.utf8   
[3] LC_MONETARY=English_United States.utf8
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.utf8    

time zone: Europe/Paris
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] palmerpenguins_0.1.1 lubridate_1.9.3      forcats_1.0.0       
 [4] stringr_1.5.1        dplyr_1.1.4          purrr_1.0.2         
 [7] readr_2.1.5          tidyr_1.3.1          tibble_3.2.1        
[10] ggplot2_3.5.1        tidyverse_2.0.0     

loaded via a namespace (and not attached):
 [1] bit_4.5.0         gtable_0.3.6      jsonlite_1.8.9    crayon_1.5.3     
 [5] compiler_4.4.2    tidyselect_1.2.1  parallel_4.4.2    scales_1.3.0     
 [9] yaml_2.3.10       fastmap_1.2.0     R6_2.5.1          labeling_0.4.3   
[13] generics_0.1.3    knitr_1.49        htmlwidgets_1.6.4 munsell_0.5.1    
[17] pillar_1.9.0      tzdb_0.4.0        rlang_1.1.4       utf8_1.2.4       
[21] stringi_1.8.4     xfun_0.49         bit64_4.5.2       timechange_0.3.0 
[25] cli_3.6.3         withr_3.0.2       magrittr_2.0.3    digest_0.6.37    
[29] grid_4.4.2        vroom_1.6.5       rstudioapi_0.17.1 hms_1.1.3        
[33] lifecycle_1.0.4   vctrs_0.6.5       evaluate_1.0.1    glue_1.8.0       
[37] farver_2.1.2      fansi_1.0.6       colorspace_2.1-1  rmarkdown_2.29   
[41] tools_4.4.2       pkgconfig_2.0.3   htmltools_0.5.8.1</code></pre>
</div>
</div>
</details>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>